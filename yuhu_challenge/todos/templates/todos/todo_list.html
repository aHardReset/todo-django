{% extends "todos/base_generic.html" %}

{% block content %}
<h2>Todo List</h2>
<form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <div class="buttons-container">
        <button type="submit" class="button button-primary">Add New Task</button>
        <button type="reset" class="button button-warning">Clear form</button>
    </div>
</form>
<div class="todos">
{% for todo in todos %}
<div class="todo-item">
    <div class="item-info">
        <div class="item-values">
            <strong>{{ todo.name }}</strong> <strong>-</strong>
            {% if todo.description %}
                <span>{{ todo.description }}</span>
            {% else %}
                <span>No Description</span>
            {% endif %}<strong>-</strong>

            {% if todo.due_date %}
                <span>{{ todo.due_date|timeuntil }}  <strong>-</strong>
            {% endif %}
        
            <i>{{ todo.user.email }}</i>
        </div>
    </div>
    <div class="action-buttons">
        <form method="post" action="{% url 'todos:delete' todo.id %}">
            {% csrf_token %}
            <button type="submit" class="button button-warning">Delete</button>
        </form> 
        <a href="{% url 'todos:update' todo.id %}" class="button-anchor-secondary" >Modify</a>
    </div>
</div>

{% empty %}
<p>No To-Do items found.</p>
{% endfor %}
</div>

<!-- Pagination -->
<div class="pagination">
    <span class="step-links">
        {% if todos.has_previous %}
            <a href="?page=1">&laquo; first</a>
            <a href="?page={{ todos.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
            Page {{ todos.number }} of {{ todos.paginator.num_pages }}.
        </span>

        {% if todos.has_next %}
            <a href="?page={{ todos.next_page_number }}">next</a>
            <a href="?page={{ todos.paginator.num_pages }}">last &raquo;</a>
        {% endif %}
    </span>
</div>
{% endblock %}
